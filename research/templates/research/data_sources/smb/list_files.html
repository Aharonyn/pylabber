{% extends "research/data_sources/data_sources_nav.html" %}
{% load django_tables2 %}
{% load crispy_forms_tags %}


{% block data-content %}

    <h4>Data Source Files</h4>
    <form id="searchForm">
        <input type="search" id="searchInput" />
        <button type="submit">Search</button>
    </form>

    <div id="treeView">

    </div>
    {% comment %} {% if filter %}
        <form action="" method="get" class="form form-inline">
            {% crispy filter.form filter.form.helper %}
        </form>
    {% endif %} {% endcomment %}

    {% comment %} <a href="{% url 'smb_archive_all' %}"><button class="btn btn-sm">Archive All</button></a> {% endcomment %}

    {% comment %} {% render_table table %} {% endcomment %}

{% endblock data-content %}

{% block extra-scripts %} 
    <script>
        $(function(){
            $(treeView).bootstrapTable({
                data: JSON.parse('{{ data | safe }}');
                height: $(window).height(),
                striped: true,
                sidePagination: 'server',
                idField: 'id',
                columns: [
                    {
                    field: 'id',
                    title: 'ID',
                    },
                    {
                    field: 'name',
                    title: 'Name'
                    },
                    {
                    field: 'status',
                    title: '状态',
                    sortable: true,
                    align: 'center',
                    formatter: 'statusFormatter'
                    },
                    {
                    field: 'permissionValue',
                    title: '权限值'
                    }
                ],
                // bootstrap-table-tree-column.js 插件配置
                // treeShowField: 'name',
                // parentIdField: 'pid'
                // bootstrap-table-tree-column.js 插件配置
                // bootstrap-table-treegrid.js 插件配置
                treeShowField: 'name',
                parentIdField: 'pid',
                onLoadSuccess: function(data) {
                    console.log('load');
                    // jquery.treegrid.js
                    $table.treegrid({
                    // initialState: 'collapsed',
                    treeColumn: 1,
                    // expanderExpandedClass: 'glyphicon glyphicon-minus',
                    // expanderCollapsedClass: 'glyphicon glyphicon-plus',
                    onChange: function() {
                        $table.bootstrapTable('resetWidth');
                    }
                    });
                }
                });
            });                
    </script>
{% endblock extra-scripts %}
